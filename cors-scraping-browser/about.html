<head>
<title>CORS scraping browser</title>
<!-- 
@author Krzysztof Kotowicz
@see http://blog.kotowicz.net
 -->
<style type="text/css">
html, body {
    font: caption;
}
dt {
    font-weight: bold;
}
</style>
</head>
<body>
<h1>CORS scraping browser</h1>
<p>By <a rel=me href="http://blog.kotowicz.net" target="_blank">Krzysztof Kotowicz</a>
<h2>Description</h2>
<p><strong>CORS scraping browser</strong> is a proof of concept of how web scraping can be done using <a target="_blank" href="http://www.w3.org/TR/cors/">Cross Origin Resource Sharing</a>.
<p>It allows you to fetch content of websites using <code>Access-Control-Allow-Origin: *</code> HTTP header, modifies it in place (e.g. removes <code>ad.&#8205;doubleclick.net</code> ads) and redisplays the content in your own origin, where you have total control over content, bypassing Same Origin Policy.
<p>By using this browser you can redisplay modified content of other websites using permissive CORS setup, potentially driving ad traffic from them. However, only public, non-authenticated content is displayed, as cookies won't work in this setup.
<h2>How to use it?</h2>
<p>Just like any other browser. <strong>Enter URL into the input field (<code>http://sourceforge.net/</code> is a good example) and press ENTER</strong>. If the target website uses <code>Access-Control-Allow-Origin: *</code>, it will load in a moment. The flying marquee at the top is a proof that you're actually modifying content. If not, there will be an alert with error.
It will only work in <strong>Firefox and Chrome</strong>!
<h2>FAQ</h2>
<dl>
<dt>Is it a demo of vulnerability?</dt>
<dd>Yes, but a tiny one. Unless the target website serves private or user-specific data without cookie or HTTP or SSL client certificate based authentication, there is no privacy breach. It's only a demonstration that you're allowing attacker to access your content through victim browser.</dd>
<dt>Has it been possible before?</dt>
<dd>You could always fetch any content issuing HTTP request to the target webserver. You didn't even have to use the browser for that, it could be a simple script. But with this technique the communication originates from victim's browser, his IP address, bandwidth etc. There is no server-side code, just a simple HTML page.</dd>
<dt>What about Flash <code>crossdomain.xml</code>?</dt>
<dd>Yes, it it also totally possible to make a similar browser using tiny Flash file for sites using <a target="_blank" href="https://www.owasp.org/index.php/Reviewing_Flash_Applications">permissive</a> <code>crossdomain.xml</code>. But now, with CORS, it's possible without any addons, HTML5-style.</dd>
<dt>How does it work?</dt>
<dd><ol>
<li>You enter URL
<li>I ask browser to use <code>XMLHttpRequest</code> to fetch that remote URL
<li>If we're lucky and website uses <code>Access-Control-Allow-Origin: *</code>, I get that content
<li>I modify the content adding marquee, base href and a making an easy attempt to remove ads
<li>I create an iframe and display the content
<li>The websites starts working in my origin, loading scripts, styles, images etc.
<li>I periodically bind to all links on the webpage and hijack them (<a target="_blank" href="http://blog.kotowicz.net/2010/11/xss-track-how-to-quietly-track-whole.html">XSS-Track</a> style) to load other URL using the same procedure.
</ol>
</dd>
<dt>Are <code>&lt;form&gt;</code> submissions supported?</dt>
<dd>Not yet, only same domain <code>&lt;a href&gt;</code> links. It's only a proof of concept. Feel free to add more.
<dt>Source code?</dt>
<dd>Well, you have it all in the <code>index.html</code>, but of course, but sure, look at <a href="https://github.com/koto/blog-kotowicz-net-examples/tree/master/cors-scraping-browser" target="_blank">my GitHub repo</a>.</dd>
</dl>
</body>